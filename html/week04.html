<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Week 4 tutorial postscript</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Week 4 tutorial postscript</h1>
<span id="author">Christopher Di Bella</span><br />
<span id="email"><code>&lt;<a href="mailto:cjdb.ns@gmail.com">cjdb.ns@gmail.com</a>&gt;</code></span><br />
<span id="revnumber">version 1,</span>
<span id="revdate"></span>
</div>
<div id="content">
<div class="sect1">
<h2 id="_some_important_terms">Some important terms</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
These should have been in the first postscript notes.
</p>
</li>
<li>
<p>
These terms are <em>probably</em> not directly assessable, but their implications are.
</p>
<div class="ulist"><ul>
<li>
<p>
That means that you <em>probably</em> won&#8217;t be asked to define them in the final exam, but
     understanding them is critical to writing good software in C++.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="sect2">
<h3 id="_implementation_defined_behaviour">Implementation-defined behaviour</h3>
<div class="ulist"><ul>
<li>
<p>
Behaviour that depends on the implementation for all well-formed programs with correct data.
</p>
</li>
<li>
<p>
The implementation (compiler) is required to document implementation-defined behaviour.
</p>
</li>
<li>
<p>
Some examples of implementation-defined behaviour include:
</p>
<div class="ulist"><ul>
<li>
<p>
the size of fundamental types (excluding <code>char</code>, <code>unsigned char</code>, and <code>signed char</code>),
</p>
</li>
<li>
<p>
type of <code>std::size_t</code>,
</p>
</li>
<li>
<p>
parameters to <code>main</code>,
</p>
</li>
<li>
<p>
whether or not <code>char</code> is signed,
</p>
</li>
<li>
<p>
lots more&#8230;
</p>
</li>
</ul></div>
</li>
<li>
<p>
You can think of this like the oil required for a car:
</p>
<div class="ulist"><ul>
<li>
<p>
Each car requires oil
</p>
</li>
<li>
<p>
Some cars have require a different grade of oil to other cars
</p>
</li>
<li>
<p>
The car manufacturer tells you which types of oil your car can use
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_unspecified_behaviour">Unspecified behaviour</h3>
<div class="ulist"><ul>
<li>
<p>
Exactly the same as implementation-defined behaviour, except:
</p>
<div class="ulist"><ul>
<li>
<p>
The implementation is <em>not</em> required to document the behaviour that occurs, and
</p>
</li>
<li>
<p>
The range of possible behaviours is often dictated by the standard.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Examples of unspecified behaviour include:
</p>
<div class="ulist"><ul>
<li>
<p>
the order in which an expression is evaluated for two expressions that are not sequenced
</p>
</li>
<li>
<p>
whether or not a reference requires storage
</p>
</li>
<li>
<p>
the order in which function arguments are evaluated
</p>
</li>
</ul></div>
</li>
<li>
<p>
Unspecified behaviour is similar to a police officer&#8217;s threshold for speeding:
</p>
<div class="ulist"><ul>
<li>
<p>
They have a threshold, and it could be <code>speed_limit * 1.1 + 3</code>
</p>
</li>
<li>
<p>
Another officer&#8217;s threshold might be <code>speed_limit * 1.1</code>
</p>
</li>
<li>
<p>
They aren&#8217;t required to tell you what their threshold is.
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_undefined_behaviour">Undefined behaviour</h3>
<div class="ulist"><ul>
<li>
<p>
The standard imposes no restrictions on what the program is allowed to do.
</p>
</li>
<li>
<p>
Your program could:
</p>
<div class="ulist"><ul>
<li>
<p>
do nothing,
</p>
</li>
<li>
<p>
loop indefinitely and then terminate when it <em>feels</em> like it,
</p>
</li>
<li>
<p>
terminate immediately,
</p>
</li>
<li>
<p>
randomly delete files,
</p>
</li>
<li>
<p>
launch nuclear missiles,
</p>
</li>
<li>
<p>
create a wormhole that transports you, and only you, to Andromeda,
</p>
</li>
<li>
<p>
or anything else
</p>
</li>
</ul></div>
</li>
<li>
<p>
There is no "but the program will usually do&#8230;" when it comes to undefined behaviour.
</p>
</li>
<li>
<p>
The compiler isn&#8217;t required to alert you to the fact you might permit undefined behaviour in your
  program.
</p>
</li>
<li>
<p>
Some examples of undefined behaviour include:
</p>
<div class="ulist"><ul>
<li>
<p>
accessing memory outside of the bounds of an array
</p>
</li>
<li>
<p>
letting a signed integer overflow or underflow
</p>
</li>
<li>
<p>
dereferencing a null pointer,
</p>
</li>
<li>
<p>
writing to the same scalar more than once in the same expression without sequencing,
</p>
</li>
<li>
<p>
deleting an object twice,
</p>
</li>
<li>
<p>
returning a reference to a local object,
</p>
</li>
<li>
<p>
race conditions,
</p>
</li>
<li>
<p>
deadlocks,
</p>
</li>
<li>
<p>
much, much more&#8230;
</p>
</li>
</ul></div>
</li>
<li>
<p>
A program that allows undefined behaviour is undefined at all points in the program: from the
  very beginning until the very end.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">Why?</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;limits&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;random&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">bomb</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> generator <span style="color: #990000">=</span> std<span style="color: #990000">::</span>mt19937<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>random_device<span style="color: #FF0000">{}</span><span style="color: #990000">()</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> distribute <span style="color: #990000">=</span> std<span style="color: #990000">::</span>uniform_int_distribution<span style="color: #990000">&lt;&gt;</span><span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>numeric_limits<span style="color: #990000">&lt;</span><span style="color: #009900">int</span><span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #000000">min</span></span><span style="color: #990000">(),</span> std<span style="color: #990000">::</span>numeric_limits<span style="color: #990000">&lt;</span><span style="color: #009900">int</span><span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #000000">max</span></span><span style="color: #990000">()</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>

   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> tick <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> i <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">generator</span></span><span style="color: #990000">();</span> i <span style="color: #990000">!=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="color: #990000">++</span>tick<span style="color: #990000">)</span>
      <span style="color: #990000">++</span>i<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Can you predict when or even <em>if</em> <code>i</code> is going to overflow?
</p>
<div class="ulist"><ul>
<li>
<p>
No, the PRNG makes it impossible to predict.
</p>
</li>
<li>
<p>
This entire function is thus undefined.
</p>
</li>
<li>
<p>
Therefore, the code calling <code>bomb</code> is undefined, and so on.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Think of undefined behaviour as driving while under the influence of a <em>lot</em> of alcohol:
</p>
<div class="ulist"><ul>
<li>
<p>
You can&#8217;t predict what&#8217;s going to happen
</p>
</li>
<li>
<p>
You can&#8217;t predict when it&#8217;s going to happen
</p>
</li>
<li>
<p>
Sometimes you might get home safely
</p>
</li>
<li>
<p>
Sometimes you might crash and hurt someone (including yourself)
</p>
</li>
<li>
<p>
Sometimes you might crash and kill someone (including yourself)
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_what_does_all_this_mean">What does all this mean?</h3>
<div class="ulist"><ul>
<li>
<p>
Guard against undefined behaviour.
</p>
</li>
<li>
<p>
Never rely on unspecified behaviour.
</p>
</li>
<li>
<p>
Code against interfaces, not against implementations.
</p>
<div class="ulist"><ul>
<li>
<p>
One easy way to do this is to use <code>auto</code> as much as possible.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   <span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #993399">10</span><span style="color: #FF0000">'000'</span><span style="color: #993399">000</span><span style="color: #FF0000">'000;</span>
<span style="color: #FF0000">   std::cout &lt;&lt; i &lt;&lt; '</span><span style="color: #990000">\</span>n<span style="color: #FF0000">';</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
This is a well-formed program, but is its behaviour defined?
</p>
</li>
<li>
<p>
Using CSE&#8217;s gcc implementation, the behaviour of this program is undefined because of the
          signed integer overflow (<code>sizeof(int) &lt; sizeof(10'000'000'000)</code>)
</p>
</li>
<li>
<p>
On a custom gcc implementation, the behaviour of this program is well-defined, since
          <code>sizeof(int) == sizeof(10'000'000'000)</code>.
</p>
</li>
<li>
<p>
Don&#8217;t expect the compiler to catch you on this!
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> i <span style="color: #990000">=</span> <span style="color: #993399">10</span><span style="color: #FF0000">'000'</span><span style="color: #993399">000</span><span style="color: #FF0000">'000;</span>
<span style="color: #FF0000">   std::cout &lt;&lt; i &lt;&lt; '</span><span style="color: #990000">\</span>n<span style="color: #FF0000">';</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Now the behaviour is well-defined for all implementations, because we are trusting the
          compiler to do its job and work out the correct type.
</p>
<div class="ulist"><ul>
<li>
<p>
Another way to combat reliance on implementations is to compile your code against two or more
      compilers (e.g. gcc <em>and</em> clang&#8230; avoid Visual C++ and Intel C++ unless necessary as they
      don&#8217;t fully implement C++14 just yet).
</p>
<div class="ulist"><ul>
<li>
<p>
Don&#8217;t rely on the inner workings of a compiler if possible.
</p>
</li>
</ul></div>
</li>
<li>
<p>
If it isn&#8217;t possible, try to localise the reliance by encapsulating it in a function that can
      easily be changed.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
ISO/IEC. Working Draft, Standard for Programming Language C++, p.3&#8201;&#8212;&#8201;4. 2014. ISO/IEC,
  Geneva Switzerland.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective STL: 50 specific ways to improve your use of the standard template
  library</em>. p.209&#8201;&#8212;&#8201;210. 2001. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.262&#8201;&#8212;&#8201;263. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em>. Fourth edition. p.136&#8201;&#8212;&#8201;137. 2013.
  Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rp-Cplusplus">CppCoreGuidelines
 &#8201;&#8212;&#8201;P.2: Write in ISO Standard C++</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Ri-except">CppCoreGuidelines
 &#8201;&#8212;&#8201;I.10: Use exceptions to signal a failure to perform a required task</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Ri-array">CppCoreGuidelines
 &#8201;&#8212;&#8201;I.13: Do not pass an array as a single pointer</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rf-value-capture">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.53: Avoid capturing by reference in lambdas that will be used nonlocally, including
  returned, stored on the heap, or passed to another thread</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-always">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.20: Always initialize an object</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-order">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.43: Avoid expressions with undefined order of evaluation</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-order-fct">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.44: Don&#8217;t depend on order of evaluation of function arguments</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-arr2">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.62: Don&#8217;t compare pointers into different arrays</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-overflow">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.103: Don&#8217;t overflow</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-underflow">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.104: Don&#8217;t underflow</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-zero">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.105: Don&#8217;t divide by zero</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Pro-type-constcast">CppCoreGuidelines
 &#8201;&#8212;&#8201;Type.3: Don&#8217;t use const_cast to cast away const (i.e., at all).</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#never-let-a-pointer-outlive-the-object-it-points-to">CppCoreGuidelines
 &#8201;&#8212;&#8201;Never let a pointer outlive the object it points to</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/ub">cppreference&#8201;&#8212;&#8201;Undefined behaviour</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/eval_order">cppreference&#8201;&#8212;&#8201;Order of evaluation</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_class_code_and_code_struct_code"><code>class</code> and <code>struct</code></h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Allows you to define your own types.
</p>
</li>
<li>
<p>
Support both data members and member functions.
</p>
</li>
<li>
<p>
Declare your member functions as <code>const</code> until you have a reason not to.
</p>
</li>
<li>
<p>
Make data members private until you have a reason not to.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Quiz</div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
What is the difference between class and struct?
</p>
</li>
<li>
<p>
What are the three access modifiers available?
</p>
</li>
<li>
<p>
When should you use a <code>struct</code>?
</p>
</li>
<li>
<p>
When should you use a <code>class</code>?
</p>
</li>
</ol></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Further reading</div>
<div class="ulist"><ul>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.201&#8201;&#8212;&#8201;213, 449&#8201;&#8212;&#8201;479. 2013.
  Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>Programming: principles and practice using C++</em>. 2nd Edition. p.173&#8201;&#8212;&#8201;254, 303
 &#8201;&#8212;&#8201;341. 2014. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>A tour of C++</em>. p.16&#8201;&#8212;&#8201;18, 33&#8201;&#8212;&#8201;57. 2014. Pearson Education Inc. Upper Saddle
  River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>Exceptional C++ style: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.104&#8201;&#8212;&#8201;128. 2005. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c-classes-and-class-hierarchies">CppCoreGuidelines
 &#8201;&#8212;&#8201;C: Classes and Class Hierarchies</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_a_href_norm_ctor_constructors_a"><a href="#norm-ctor">Constructors</a></h3>
<div class="ulist"><ul>
<li>
<p>
A special function that does not return.
</p>
</li>
<li>
<p>
Responsible for creating the object.
</p>
</li>
<li>
<p>
There are three different kinds of constructor:
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="#norm-ctor">Constructor</a>
</p>
</li>
<li>
<p>
<a href="#copy-ctor">Copy constructor</a>
</p>
</li>
<li>
<p>
<a href="#move-ctor">Move constructor</a>
</p>
</li>
</ul></div>
</li>
<li>
<p>
If you don&#8217;t need to define a copy constructor or a move constructor, <em>don&#8217;t</em> define them.
</p>
</li>
<li>
<p>
Use member initialisers over default constructors wherever possible.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">film</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">()</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">default</span></span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> title<span style="color: #990000">,</span>
        <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> director<span style="color: #990000">,</span>
        <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>std<span style="color: #990000">::</span>string<span style="color: #990000">&gt;&amp;</span> cast<span style="color: #990000">,</span>
        std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue<span style="color: #990000">);</span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> title_<span style="color: #FF0000">{</span><span style="color: #FF0000">"&lt;title-unknown&gt;"</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> director_<span style="color: #FF0000">{</span><span style="color: #FF0000">"&lt;director-unknown&gt;"</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;std::string&gt;</span> cast_<span style="color: #FF0000">{}</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue_<span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

film<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> title<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> director<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>std<span style="color: #990000">::</span>string<span style="color: #990000">&gt;&amp;</span> cast<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue<span style="color: #990000">)</span>
   <span style="color: #990000">:</span> title_<span style="color: #FF0000">{</span>title<span style="color: #FF0000">}</span><span style="color: #990000">,</span> director_<span style="color: #FF0000">{</span>director<span style="color: #FF0000">}</span><span style="color: #990000">,</span> cast_<span style="color: #FF0000">{</span>cast<span style="color: #FF0000">}</span><span style="color: #990000">,</span> revenue_<span style="color: #FF0000">{</span>revenue<span style="color: #FF0000">}</span>
<span style="color: #FF0000">{</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Quiz</div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
What happens when you don&#8217;t define a constructor at all?
</p>
</li>
<li>
<p>
What happens when you don&#8217;t define a default constructor?
</p>
</li>
<li>
<p>
What is a delegating constructor?
</p>
</li>
<li>
<p>
Why is the body of the above constructor empty?
</p>
</li>
<li>
<p>
What is an explicit constructor?
</p>
</li>
<li>
<p>
When is an explicit constructor useful?
</p>
</li>
<li>
<p>
Why do we like explicit constructors?
</p>
</li>
<li>
<p>
What is a member initialiser?
</p>
</li>
</ol></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.34&#8201;&#8212;&#8201;37. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.481&#8201;&#8212;&#8201;484, 487&#8201;&#8212;&#8201;488, 489
 &#8201;&#8212;&#8201;506. 2013. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>Programming: principles and practice using C++</em>. 2nd Edition. p.173&#8201;&#8212;&#8201;254, 303
 &#8201;&#8212;&#8201;341. 2014. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>More exceptional C++: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.115&#8201;&#8212;&#8201;126. 2002. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/initializer_list">cppreference&#8201;&#8212;&#8201;Constructors and
  member initializer lists</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/default_constructor">cppreference&#8201;&#8212;&#8201;Default
  constructors</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-ctor">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.40: Define a constructor if a class has an invariant</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-complete">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.41: A constructor should create a fully initialized object</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-throw">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.42: If a constructor cannot construct a valid object, throw an exception</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-default0">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.43: Ensure that a class has a default constructor</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-default00">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.44: Prefer default constructors to be simple and non-throwing</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-default">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.45: Don&#8217;t define a default constructor that only initializes data members; use in-class
  member initializers instead</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-explicit">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.46: By default, declare single-argument constructors explicit</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-order">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.47: Define and initialize member variables in the order of member declaration</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-in-class-initializer">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.48: Prefer in-class initializers to member initializers in constructors for constant initializers</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-initialize">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.49: Prefer initialization to assignment in constructors</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-delegating">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.51: Use delegating constructors to represent common actions for all constructors of a class</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-inheriting">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.52: Use inheriting constructors to import constructors into a derived class that does not
  need further explicit initialization</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_code_const_code_member_functions"><code>const</code> member functions</h3>
<div class="ulist"><ul>
<li>
<p>
Promise that the function won&#8217;t modify any non-<code>mutable</code> data members.
</p>
</li>
<li>
<p>
Can only call other <code>const</code> member functions.
</p>
</li>
<li>
<p>
Objects specified to be <code>const</code> can only call <code>const</code> member functions.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">film</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>std<span style="color: #990000">::</span>string<span style="color: #990000">&gt;&amp;,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>int64_t<span style="color: #990000">);</span>
   <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">title</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> title_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> director_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;std::string&gt;</span> cast_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

film<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> title<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> director<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>std<span style="color: #990000">::</span>string<span style="color: #990000">&gt;&amp;</span> cast<span style="color: #990000">,</span>
           <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue<span style="color: #990000">);</span>
   <span style="color: #990000">:</span> title_<span style="color: #FF0000">{</span>title<span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     director_<span style="color: #FF0000">{</span>director<span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     cast_<span style="color: #FF0000">{</span>cast<span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     revenue_<span style="color: #FF0000">{</span>revenue<span style="color: #FF0000">}</span>
<span style="color: #FF0000">{</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> film<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">title</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span>
<span style="color: #FF0000">{</span>
   title_ <span style="color: #990000">=</span> <span style="color: #FF0000">"Star Wars: The Empire Strikes Back"</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// error: title_ is immutable in this function</span></span>
   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> title_<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// okay</span></span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Quiz</div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
How should you be returning data members by default?
</p>
</li>
<li>
<p>
When should you not be returning data members this way?
</p>
</li>
</ol></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_code_mutable_code_data_members"><code>mutable</code> data members</h3>
<div class="ulist"><ul>
<li>
<p>
The exception to the <code>const</code> rule: you can modify a <code>mutable</code> data member inside a <code>const</code>
  function.
</p>
</li>
<li>
<p>
Sounds shady, right?
</p>
</li>
<li>
<p>
Only very carefully chosen members should be <code>mutable</code> (e.g. a cache).
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">cinema</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-style: italic"><span style="color: #9A1900">// ...</span></span>
   <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> film<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">top_grossing_film</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">push_back</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> film<span style="color: #990000">&amp;);</span> <span style="font-style: italic"><span style="color: #9A1900">// inserts film and sets top_film_ to nullptr</span></span>
   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">erase</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span><span style="color: #008080">size_t</span> i<span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">// erases film and sets top_film_ to nullptr</span></span>
   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">clear</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">// erases all films and sets top_film_ to nullptr</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;film&gt;</span> films_<span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">mutable</span></span> <span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>films_<span style="color: #990000">)::</span><span style="color: #008080">const_pointer</span> top_film_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

<span style="font-weight: bold"><span style="color: #0000FF">const</span></span> film<span style="color: #990000">&amp;</span> cinema<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">top_grossing_film</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span>top_film_<span style="color: #990000">)</span>
   <span style="color: #FF0000">{</span>
      top_film_ <span style="color: #990000">=</span> <span style="color: #990000">&amp;</span>films_<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">];</span> <span style="font-style: italic"><span style="color: #9A1900">// reset top_film_ so it isn't a dangling pointer</span></span>
      <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span><span style="color: #990000">&amp;</span> f <span style="color: #990000">:</span> films_<span style="color: #990000">)</span>
         top_film_ <span style="color: #990000">=</span> <span style="color: #990000">&amp;</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">max</span></span><span style="color: #990000">(</span>f<span style="color: #990000">,</span> <span style="color: #990000">*</span>top_film_<span style="color: #990000">);</span>
      cache_invalidated_ <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">false</span></span><span style="color: #990000">;</span>
   <span style="color: #FF0000">}</span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span>top_film_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References for <code>const</code> member functions and <code>mutable</code> data members</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.19&#8201;&#8212;&#8201;26. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.461&#8201;&#8212;&#8201;464. 2013. Pearson
  Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>Exceptional C++: 47 engineering puzzles, programming problems, and solutions}</em>.
  p.69&#8201;&#8212;&#8201;75, 177&#8201;&#8212;&#8201;184. 2000. Pearson Education, Inc. Indianapolis, IN.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-casts-const">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.50: Don&#8217;t cast away <code>const</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rconst-fct">CppCoreGuidelines
 &#8201;&#8212;&#8201;Con.2: By default, make member functions <code>const</code></a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/member_functions#const-.2C_volatile-.2C_and_ref-qualified_member_functions">cppreference
 &#8201;&#8212;&#8201;Non-static member functions: const-, volatile-, and ref-qualified member functions</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/cv">cppreference&#8201;&#8212;&#8201;cv (<code>const</code> and <code>volatile</code>)
  type qualifiers</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_code_inline_code_functions"><code>inline</code> functions</h3>
<div class="ulist"><ul>
<li>
<p>
A function that is prefixed with the <code>inline</code> specifier declares an inline function, which allows
  it to be defined multiple times.
</p>
<div class="ulist"><ul>
<li>
<p>
Each definition must be identical (including the <code>inline</code> specifier), and
</p>
</li>
<li>
<p>
the function must be defined in every file it is call.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The most common way to enforce these two requirements is to write an inline function once in a
  header, and to simply include that header whenever you need to call the function.
</p>
</li>
<li>
<p>
Functions that are declared inside a class body are implicitly <code>inline</code>: putting the <code>inline</code>
  specifier in front of the function signature is superfluous.
</p>
</li>
<li>
<p>
We declare inline functions to hint to the compiler that it should replace function calls with the
  body of the function.
</p>
<div class="ulist"><ul>
<li>
<p>
This can potentially improve performance, as the call overhead is lost.
</p>
</li>
<li>
<p>
You could also bloat the size of your code, which might pessimise your code too.
</p>
</li>
<li>
<p>
<strong>Remember to test for performance before making performance claims.</strong>
</p>
</li>
<li>
<p>
You can always inline a function later, if necessary.
</p>
</li>
<li>
<p>
We often inline small functions, such as accessors, simple mutators, and constructors without
      bodies.
</p>
</li>
<li>
<p>
Just because a function has been specified as <code>inline</code> does not mean that the compiler will
      listen to your recommendation and actually inline the function body.
</p>
</li>
</ul></div>
</li>
<li>
<p>
If you are concerned about revealing your implementation to clients and this breaking
  encapsulation, understand that:
</p>
<div class="ulist"><ul>
<li>
<p>
C++ encapsulation guards against mistakes, not fraud or espionage.
</p>
<div class="ulist"><ul>
<li>
<p>
Provided no one acts upon the encapsulated code, it doesn&#8217;t really matter if they can see
          your implementation.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Splitting code into headers and implementation files makes compilation easier (faster).
</p>
</li>
<li>
<p>
Stick to the small functions that don&#8217;t reveal too much.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<code>main</code> may not be declared as an inline function.
</p>
</li>
<li>
<p>
Prefer <code>inline</code> functions to <code>#define</code> macros.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">// An inline example</span></span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;fstream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;string&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;vector&gt;</span>

<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">book</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-weight: bold"><span style="color: #000000">book</span></span><span style="color: #990000">(</span>std<span style="color: #990000">::</span>istream<span style="color: #990000">&amp;);</span> <span style="font-style: italic"><span style="color: #9A1900">// not an inline function... defined elsewhere</span></span>

   <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">author</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> author_<span style="color: #990000">;</span> <span style="color: #FF0000">}</span> <span style="font-style: italic"><span style="color: #9A1900">// implicit inline function</span></span>
   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">author</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> s<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> author_ <span style="color: #990000">=</span> s<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>    <span style="font-style: italic"><span style="color: #9A1900">// another implicit inline function</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> author_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

<span style="font-style: italic"><span style="color: #9A1900">// freestanding functions _need_ to be declared as inline</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">inline</span></span> <span style="color: #008080">book</span> <span style="font-weight: bold"><span style="color: #000000">read_file</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> filename<span style="color: #990000">);</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">using</span></span> <span style="font-weight: bold"><span style="color: #0000FF">namespace</span></span> std<span style="color: #990000">::</span>literals<span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> library <span style="color: #990000">=</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>book<span style="color: #990000">&gt;</span><span style="color: #FF0000">{</span><span style="font-weight: bold"><span style="color: #000000">read_file</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"tour++.book"</span><span style="color: #990000">),</span> <span style="font-weight: bold"><span style="color: #000000">read_file</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"pppuc++.book"</span><span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> filename <span style="color: #990000">=</span> <span style="color: #FF0000">""</span>s<span style="color: #990000">;</span> std<span style="color: #990000">::</span>cin <span style="color: #990000">&gt;&gt;</span> filename<span style="color: #990000">;</span> <span style="color: #990000">)</span>
      library<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push_back</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">read_file</span></span><span style="color: #990000">(</span>filename<span style="color: #990000">));</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #0000FF">inline</span></span> <span style="color: #008080">book</span> <span style="font-weight: bold"><span style="color: #000000">read_file</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> filename<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">using</span></span> <span style="font-weight: bold"><span style="color: #0000FF">namespace</span></span> std<span style="color: #990000">::</span>literals<span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> in <span style="color: #990000">=</span> std<span style="color: #990000">::</span>ifstream<span style="color: #FF0000">{</span>filename<span style="color: #FF0000">}</span><span style="color: #990000">)</span>
      <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> book<span style="color: #FF0000">{</span>in<span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> std<span style="color: #990000">::</span>runtime_error<span style="color: #FF0000">{</span><span style="color: #FF0000">"Cannot open file "</span>s <span style="color: #990000">+</span> filename<span style="color: #FF0000">}</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
ISO/IEC. Working Draft, Standard for Programming Language C++, p.151&#8201;&#8212;&#8201;152. 2014. ISO/IEC,
  Geneva Switzerland.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.13&#8201;&#8212;&#8201;17, 134&#8201;&#8212;&#8201;139. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.307, 310&#8201;&#8212;&#8201;311. 2013. Pearson
  Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>More exceptional C++: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.83&#8201;&#8212;&#8201;85. 2002. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
Sutter, H. <em>Exceptional C++ style: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.190&#8201;&#8212;&#8201;198. 2005. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rf-inline">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.5: If a function is very small and time-critical, declare it <code>inline</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rs-inline">CppCoreGuidelines
 &#8201;&#8212;&#8201;SF.2: A .h file may not contain object definitions or non-inline function definitions</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/inline">cppreference&#8201;&#8212;&#8201;<code>inline</code> specifier</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_friend_s">`friend`s</h3>
<div class="ulist"><ul>
<li>
<p>
Have access to a class&#8217;s privates.
</p>
</li>
<li>
<p>
Are functions or even whole classes that have the <em>same</em> access as any function within the
  class.
</p>
</li>
<li>
<p>
Avoid them if you can.
</p>
</li>
<li>
<p>
Prefer non-member, non-friend functions when possible.
</p>
<div class="ulist"><ul>
<li>
<p>
Non-member, non-friend functions help to improve encapsulation.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.571&#8201;&#8212;&#8201;576. 2013. Pearson
  Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.98&#8201;&#8212;&#8201;102. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/friend">cppreference&#8201;&#8212;&#8201;<code>friend</code> declaration</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resource_acquisition_is_initialisation_or_as_it_8217_s_called_in_lectures_copy_control">Resource Acquisition is Initialisation (or as it&#8217;s called in lectures, "Copy Control")</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
The <em>single</em> most powerful feature C++ has to offer.
</p>
</li>
<li>
<p>
More important than object-oriented programming and generic programming.
</p>
</li>
<li>
<p>
It&#8217;s not just a language feature, but a programming idiom.
</p>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
You allocate a resource.
</p>
</li>
<li>
<p>
You use the resource.
</p>
</li>
<li>
<p>
You clean up the resource yourself, but the compiler decides when it happens.
</p>
</li>
<li>
<p>
That&#8217;s the general idea!
</p>
</li>
</ol></div>
</li>
</ul></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<caption class="title">Table 1. What is a resource?</caption>
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top">Example                                                                                  </th>
<th align="left" valign="top">Do we ned to worry about it (in modern C++)?</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">A file handle.</p></td>
<td align="left" valign="top"><p class="table"><code>ofstream</code> and <code>ifstream</code> already worry about cleaning up file handles, so unless you have some reason not to use them, you don&#8217;t need to worry about file handles.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">An <em>owning</em> pointer, or a pointer that is responsible for deallocating free store memory.</p></td>
<td align="left" valign="top"><p class="table">All owning pointers should be smart pointers where possible, so this is rarely a concern.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">A mutex.</p></td>
<td align="left" valign="top"><p class="table">We&#8217;ll cover mutexes another day, but there&#8217;s stuff for them too.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Some other system-related stuff&#8230;</p></td>
<td align="left" valign="top"><p class="table">You&#8217;ll need to inspect the standard library and GSL to see for yourself.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="ulist"><ul>
<li>
<p>
You&#8217;ve been using it a lot already without knowing:
</p>
<div class="ulist"><ul>
<li>
<p>
<code>vector</code> employs it (it dynamically allocates memory, but you never personally clean it up)
</p>
</li>
<li>
<p>
<code>ifstream</code> employs it (you open the file handle, but you never personally close it)
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<caption class="title">Table 2. It&#8217;s not garbage collection.</caption>
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top">Garbage collection                                                                      </th>
<th align="left" valign="top">RAII</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">is a fire and forget tool employed by a runtime.</p></td>
<td align="left" valign="top"><p class="table">is a programming idiom actively employed by vigilant programmers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">can happen at any point <em>from</em> the end of an object&#8217;s life to the program&#8217;s termination.</p></td>
<td align="left" valign="top"><p class="table">is guaranteed to happen <em>at</em> the end of an object&#8217;s life.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.61&#8212;6, 69&#8201;&#8212;&#8201;73. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.354&#8212;7. 2013. Pearson Education
  Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>Programming: principles and practice using C++</em>. 2nd Edition. p.1221, 303
 &#8201;&#8212;&#8201;341. 2014. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>A tour of C++</em>. p.118. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>Exceptional C++: 47 engineering puzzlies, programming problems, and solutions</em>.
  p.25&#8201;&#8212;&#8201;68, 167&#8201;&#8212;&#8201;174. 2000. Pearson Education, Inc. Indianapolis, IN.
</p>
</li>
<li>
<p>
Sutter, H. <em>More exceptional C++: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.115&#8201;&#8212;&#8201;126. 2002. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rr-raii">CppCoreGuidelines
 &#8201;&#8212;&#8201;R.1: Manage resources automatically using resource handles and RAII (Resource Acquisition Is
  Initialization)</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/raii">cppreference&#8201;&#8212;&#8201;RAII</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="sect2">
<h3 id="_destructor_copy_constructor_copy_assignment_and_the_rule_of_three">Destructor, copy constructor, copy assignment, and the rule of three</h3>
<div class="ulist"><ul>
<li>
<p>
The destructor is a function that&#8217;s (usually) automatically called at the end of an object&#8217;s
  lifetime.
</p>
<div class="ulist"><ul>
<li>
<p>
If you don&#8217;t define one, it&#8217;ll be synthesised for you.
</p>
</li>
<li>
<p>
It is responsible for cleaning up any members, but it doesn&#8217;t automatically clean up resources
      that you reserve.
</p>
<div class="ulist"><ul>
<li>
<p>
If you reserve resources, you will need to define a destructor and manually specify how
          the resources are to be cleaned up.
</p>
</li>
</ul></div>
</li>
<li>
<p>
It is specified to be <code>noexcept</code> by default, and you shouldn&#8217;t allow an exception to leave the
      destructor unless you want all kinds of trouble.
</p>
</li>
<li>
<p>
Creating a destructor to clear a <code>vector</code> or set an <code>int</code> to 0 is redundant and should not be
      done.
</p>
</li>
</ul></div>
</li>
<li>
<p>
A copy constructor is responsible for copying resources from an object into an object that is
  being constructed.
</p>
<div class="ulist"><ul>
<li>
<p>
If you don&#8217;t define one, it&#8217;ll be synthesised for you.
</p>
</li>
<li>
<p>
You are responsible for ensuring that resources you reserve are correctly copied.
</p>
</li>
<li>
<p>
Creating a copy constructor just to copy a <code>vector</code> is redundant, and shouldn&#8217;t be done.
</p>
</li>
</ul></div>
</li>
<li>
<p>
A copy assignment operator is responsible for copying resources from an object A into a
  pre-existing object B, <em>and</em> cleaning up the original resources in B.
</p>
<div class="ulist"><ul>
<li>
<p>
If you don&#8217;t define one, it&#8217;ll be synthesised for you.
</p>
</li>
<li>
<p>
You are responsible for ensuring that any resources that B currently holds are appropriately
     cleaned up, and then properly copying the resources across from A.
</p>
</li>
<li>
<p>
Creating a copy assignment operator just to copy a <code>vector</code>, or <em>ensure</em> that your objects have
     the same values is redundant, and shouldn&#8217;t be done.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="title">Be aware for self-assignment</div>
<div class="ulist"><ul>
<li>
<p>
If you perform <code>a = a;</code>, the state of <code>a</code> must remain the same.
</p>
</li>
<li>
<p>
There are three copy assignment operators below, one is incorrect, one is recommended, and one
  should only be used with good reason.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> d<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span> data_<span style="color: #990000">;</span>
   data_ <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> T<span style="color: #FF0000">{</span><span style="color: #990000">*</span>d<span style="color: #990000">.</span>data_<span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
What can go wrong with the above?
</p>
<div class="ulist"><ul>
<li>
<p>
If we perform <code>a = a</code>, then we have just deleted the data we wish to copy.
</p>
</li>
<li>
<p>
We are also dereferencing a dangling pointer. The result of this is undefined.
</p>
</li>
<li>
<p>
This should be rejected by compiler warnings, lint tools, a static analysers, <em>and</em> code
     reviews, but don&#8217;t expect compiler warnings alone to stop you.
</p>
</li>
<li>
<p>
This is the not-recommended one.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">// check-for-self implementation</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> d<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span> <span style="color: #990000">!=</span> <span style="color: #990000">&amp;</span>d<span style="color: #990000">)</span>
   <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span> data_<span style="color: #990000">;</span>
      data_ <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> T<span style="color: #FF0000">{</span><span style="color: #990000">*</span>d<span style="color: #990000">.</span>data_<span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="color: #FF0000">}</span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
This is better, but there&#8217;s still a few things to consider:
</p>
<div class="ulist"><ul>
<li>
<p>
If we perform <code>a = a</code>, then the resources are preserved.
</p>
</li>
<li>
<p>
This is production-okay code.
</p>
</li>
<li>
<p>
This shouldn&#8217;t be rejected by lint tools and static analysers, but might be rejected by a
     strict code review team.
</p>
</li>
<li>
<p>
The key problem is that we need to explicitly release any held resources and then allocate new
     resources, and we might forget to do it.
</p>
</li>
<li>
<p>
We&#8217;ve also already done both of these in our copy constructor and our destructor, so there&#8217;s
     now some code duplication.
</p>
</li>
<li>
<p>
If only there were a way to reduce code duplication&#8230;
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">// copy-and-swap implementation</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
<span style="color: #008080">smart_ptr&lt;T&gt;&amp; smart_ptr&lt;T&gt;::operator=(smart_ptr&lt;T&gt;</span> d<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">// d is passed by value, which invokes the copy constructor</span></span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">using</span></span> std<span style="color: #990000">::</span>swap<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// _always_ do this</span></span>
   <span style="font-weight: bold"><span style="color: #000000">swap</span></span><span style="color: #990000">(*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> d<span style="color: #990000">);</span>  <span style="font-style: italic"><span style="color: #9A1900">// resources of our old smart_ptr go into t</span></span>
   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span> <span style="font-style: italic"><span style="color: #9A1900">// d cleaned up here by definition</span></span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
&#8230;which we can do by invoking the copy constructor and the destructor!
</p>
</li>
<li>
<p>
There&#8217;s still a problem with this one.
</p>
<div class="ulist"><ul>
<li>
<p>
If <code>this == &amp;d</code>, then we&#8217;ve just performed an expensive copy for nothing!
</p>
</li>
<li>
<p>
Fortunately, there&#8217;s a simple fix:
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">// check-for-self + copy-and-swap</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> d<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">// d is passed by reference-to-const again</span></span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span> <span style="color: #990000">!=</span> <span style="color: #990000">&amp;</span>d<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">// avoid the expensive copy if it's self-assignment</span></span>
   <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">using</span></span> std<span style="color: #990000">::</span>swap<span style="color: #990000">;</span>
      <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> t <span style="color: #990000">=</span> d<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// we copy d into t via the smart_ptr&lt;T&gt; copy constructor</span></span>
      <span style="font-weight: bold"><span style="color: #000000">swap</span></span><span style="color: #990000">(*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> t<span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">// resources from the copy go into t</span></span>
   <span style="color: #FF0000">}</span> <span style="font-style: italic"><span style="color: #9A1900">// t cleaned up here</span></span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
This is the preferred copy assingment operator.
</p>
<div class="ulist"><ul>
<li>
<p>
Exception: when you are allocating an array on the free store.
</p>
</li>
<li>
<p>
That&#8217;s when you go back to the original check-for-self copy assignment operator.
</p>
</li>
</ul></div>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="ulist"><ul>
<li>
<p>
<span class="big"><strong>The rule of three states that if you have a need to implement one of these, you must implement
  all of them.</strong></span>
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
There is no compiler check to see if you do or do not implement all three.
</p>
</li>
<li>
<p>
There is also no compiler check to see if you have correctly implemented any of them.
</p>
</li>
<li>
<p>
A static analyser may help, but do not expect it to catch everything you&#8217;ve missed.
</p>
</li>
<li>
<p>
This is a part of the RAII programming idiom, and is up to you to enforce.
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>More effective C++: 35 new ways to improve your programs and designs</em>. p.41&#8201;&#8212;&#8201;68. 1996.
  Addison Wesley. Westford, MA.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective C++: 55 specific ways to improve your programs and designs</em>.
  Third edition. p.44&#8201;&#8212;&#8201;60, 66&#8201;&#8212;&#8201;73. 2005. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.481&#8201;&#8212;&#8201;9, 507&#8201;&#8212;&#8201;14, 520&#8201;&#8212;&#8201;3. 2013.
  Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>Programming: principles and practice using C++</em>. 2nd Edition. p.601&#8201;&#8212;&#8201;5,
  633&#8201;&#8212;&#8201;7, 640&#8201;&#8212;&#8201;6. 2014. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Sutter, H. <em>Exceptional C++: 47 engineering puzzlies, programming problems, and solutions</em>.
  p.9&#8201;&#8212;&#8201;17, 25&#8201;&#8212;&#8201;68. 2000. Pearson Education, Inc. Indianapolis, IN.
</p>
</li>
<li>
<p>
Sutter, H. <em>More exceptional C++: 40 new engineering puzzles, programming problems, and
  solutions</em>. p.126&#8201;&#8212;&#8201;131. 2002. Pearson Education, Inc. Boston, MA.
</p>
</li>
<li>
<p>
<a href="http://stackoverflow.com/a/9322542/4097528">StackOverflow: Howard Hinnant&#8217;s answer to
  "Move assignment operator and <code>if (this != &amp;rhs)</code>"</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/copy_constructor">cppreference&#8201;&#8212;&#8201;Copy
  constructors</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/copy_assignment">cppreference&#8201;&#8212;&#8201;Copy assignment
  operator</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/destructor">cppreference&#8201;&#8212;&#8201;Destructors</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/rule_of_three">cppreference&#8201;&#8212;&#8201;The rule of
  three/five/zero</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#cctor-constructors-assignments-and-destructors">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.ctor: Constructors, assignments, and destructors</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-zero">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.20: If you can avoid defining default operations, do</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-matched">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.22: Make default operations consistent</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-copy-assignment">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.60: Make copy assignment non-virtual, take the parameter by <code>const&amp;</code>, and return by <code>non-const&amp;</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c61-a-copy-operation-should-copy">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.61: A copy operation should copy</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-copy-self">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.62: Make copy assignment safe for self-assignment</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.30: Define a destructor if a class needs an explicit action at object destruction</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-release">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.31: All resources acquired by a class must be released by the class&#8217;s destructor</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-ptr">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.32: If a class has a raw pointer (<code>T*</code>) or reference (<code>T&amp;</code>), consider whether it might be owning</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-ptr2">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.33: If a class has an owning pointer member, define a destructor</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-ref">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.34: If a class has an owning reference member, define a destructor</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-fail">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.36: A destructor may not fail</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-dtor-noexcept">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.37: Make destructors <code>noexcept</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#define-copy-move-and-destroy-consistently">CppCoreGuidelines
 &#8201;&#8212;&#8201;Define Copy, move, and destroy consistently</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_rvalue_references">Rvalue references</h3>
<div class="ulist"><ul>
<li>
<p>
We learned about <em>lvalue</em> references in week 1.
</p>
</li>
<li>
<p>
An lvalue reference refers to some lvalue (a function or object).
</p>
</li>
<li>
<p>
You cannot bind an lvalue reference to an rvalue, but you may bind an lvalue reference-to-<code>const</code>
  to an rvalue.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">auto</span></span><span style="color: #990000">&amp;</span> reference_to_int <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// error: can't bind an lvalue reference to an rvalue</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span><span style="color: #990000">&amp;</span> reference_to_const_int <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// okay</span></span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Rvalue references refer to rvalues.
</p>
<div class="ulist"><ul>
<li>
<p>
Rvalue references cannot bind to lvalues.
</p>
</li>
</ul></div>
</li>
<li>
<p>
They may bind to temporaries, which are a form of rvalue.
</p>
<div class="ulist"><ul>
<li>
<p>
A temporary is an object without a name.
</p>
</li>
<li>
<p>
A temporary is destroyed at the end of the full expression it is constructed in.
</p>
</li>
</ul></div>
</li>
<li>
<p>
They may also bind to lvalues that are nearing the end of their lifetime.
</p>
<div class="ulist"><ul>
<li>
<p>
We need to explicitly tell the compiler about this, but more on this later.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Rvalue references are used for <em>destructive</em> reads.
</p>
<div class="ulist"><ul>
<li>
<p>
An rvalue reference-to-<code>const</code> is thus pointless.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">auto</span></span><span style="color: #990000">&amp;&amp;</span> rvalue_reference <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// okay</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span><span style="color: #990000">&amp;&amp;</span> rvalue_reference_to_const <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// legal, but the rvalue reference is now useless.</span></span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/reference">cppreference&#8201;&#8212;&#8201;Reference declaration</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#f18-for-consume-parameters-pass-by-x-and-stdmove-the-parameter">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.18: For "consume" parameters, pass by <code>X&amp;&amp;</code> and <code>std::move</code> the parameter</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rf-return-ref-ref">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.45 Don&#8217;t return a <code>T&amp;&amp;</code></a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_move_constructor_move_assignment_and_the_rule_of_five">Move constructor, move assignment, and the rule of five</h3>
<div class="ulist"><ul>
<li>
<p>
A fax machine scans your document and replicates it. This is akin to copying.
</p>
</li>
<li>
<p>
Handing a document to another person means that you no longer have the document, and only one
  document is in circulation. This is akin to moving.
</p>
</li>
<li>
<p>
Moving things happens at the near of an object&#8217;s lifetime.
</p>
<div class="ulist"><ul>
<li>
<p>
Does that sound familiar?
</p>
</li>
<li>
<p>
Moving works with rvalue references.
</p>
</li>
</ul></div>
</li>
<li>
<p>
An object that has been moved is left in a valid, but unspecified state.
</p>
<div class="ulist"><ul>
<li>
<p>
You may perform operations that do not have any preconditions on a recently-moved object.
</p>
</li>
<li>
<p>
Performing operations with postconditions on a recently-moved object can cause undefined
      behaviour, because we don&#8217;t know what the state of the object is when we operate on it.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<strong>The rule of five is an extension to the rule of three, requiring you to supply a user-defined
     move constructor, <em>and</em> a user-defined move assignment operator.</strong>
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_move_constructors">Move constructors</h4>
<div class="ulist"><ul>
<li>
<p>
Move constructors are responsible for moving all of an object&#8217;s resources from a preexisting
  object to an object that is just being constructed.
</p>
</li>
<li>
<p>
The rules for a synthesised move constructor are stricter than those for a copy constructor.
  Namely, you must not have defined a custom:
</p>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Copy constructor
</p>
</li>
<li>
<p>
Copy assignment operator
</p>
</li>
<li>
<p>
Destructor
</p>
</li>
<li>
<p>
Move constructor (no point synthesising one if you already made it&#8201;&#8212;&#8201;you know better than
      the compiler, after all!)
</p>
</li>
<li>
<p>
Move assignment operator
</p>
</li>
</ol></div>
</li>
<li>
<p>
Similarly to the above, defining your own to explicitly move anything other than a resource is
     redundant.
</p>
</li>
<li>
<p>
Similarly to all other constructors, make sure that you use your initialiser list.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #000000">smart_ptr</span></span><span style="color: #990000">(</span>smart_ptr<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;&amp;</span> o<span style="color: #990000">)</span>
   <span style="color: #990000">:</span> data_<span style="color: #FF0000">{</span>o<span style="color: #990000">.</span>data_<span style="color: #FF0000">}</span>
<span style="color: #FF0000">{</span>
   o<span style="color: #990000">.</span>data_ <span style="color: #990000">=</span> nullptr<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// o.data_ is no longer an owner of the</span></span>
                      <span style="font-style: italic"><span style="color: #9A1900">// object, and cannot point to the resource.</span></span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
If you&#8217;d like to move something other than a built-in type, you&#8217;ll need to use a special function
  called <code>std::move</code>.
</p>
<div class="ulist"><ul>
<li>
<p>
<em>Never</em> dequalify <code>std::move</code>, not even with <code>using std::move</code>.
</p>
</li>
<li>
<p>
It is a very important function, and has a common name. Mixing it up with some other function
     is very, <em>very</em> bad.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #000000">magic</span></span><span style="color: #990000">(</span>magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;&amp;</span> o<span style="color: #990000">)</span>
   <span style="color: #990000">:</span> data_<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>o<span style="color: #990000">.</span>data_<span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">,</span> <span style="font-style: italic"><span style="color: #9A1900">// data_ is a vector&lt;T&gt;</span></span>
     resource_<span style="color: #FF0000">{</span>o<span style="color: #990000">.</span>resource_<span style="color: #FF0000">}</span> <span style="font-style: italic"><span style="color: #9A1900">// resource_ is a pointer pointing to something on the free store</span></span>
<span style="color: #FF0000">{</span>
   o<span style="color: #990000">.</span>resource_ <span style="color: #990000">=</span> nullptr<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
Notice that we didn&#8217;t do anything with <code>o.data_</code>, like we did with <code>o.resource_</code>. This is because
  <code>vector</code> has a move constructor that does all of that for us.
</p>
<div class="ulist"><ul>
<li>
<p>
If we weren&#8217;t explicitly managing <code>resource_</code>, then we wouldn&#8217;t bother defining the any of the
     five.
</p>
</li>
</ul></div>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
<code>std::move</code> doesn&#8217;t actually move anything on its own.
</p>
</li>
<li>
<p>
It is a wrapper for a <code>static_cast&lt;T&amp;&amp;&gt;</code>, where <code>T</code> is the type you pass to <code>std::move</code>.
</p>
</li>
<li>
<p>
All the moving happens in the constructor we&#8217;ve just spoken about, and the assignment operator
  below.
</p>
</li>
<li>
<p>
<code>std::move</code> is a trick to get the compiler to let us move an lvalue.
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_move_assignment_operators">Move assignment operators</h4>
<div class="ulist"><ul>
<li>
<p>
Similarly to copy assignment, move assignment is responsible for moving resources from an object A
  to a prexisting object B, after having released the resources that B holds.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
<div class="title">Self-assignment with the move constructor</div>
<div class="ulist"><ul>
<li>
<p>
The standard implies that self-assignment with a move assignment operator is unspecified.
</p>
<div class="ulist"><ul>
<li>
<p>
It could clear out the object (same as xoring with itself), or
</p>
</li>
<li>
<p>
It could be a no-op (i.e. optimised out)
</p>
</li>
</ul></div>
</li>
<li>
<p>
If you want the former to happen, don&#8217;t check for self-assignment: a correctly written move
  assignment operator will cause this to happen automatically.
</p>
</li>
<li>
<p>
If you prefer the latter to happen, you cannot employ the copy-and-swap method used in the copy
  assignment operator.
</p>
</li>
<li>
<p>
You must use the check-for-self method, like so:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span>magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;&amp;</span> m<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span> <span style="color: #990000">!=</span> <span style="color: #990000">&amp;</span>r<span style="color: #990000">)</span>
   <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span><span style="color: #990000">[]</span> resource_<span style="color: #990000">;</span>
      resource_ <span style="color: #990000">=</span> m<span style="color: #990000">.</span>resource_<span style="color: #990000">;</span>
      m<span style="color: #990000">.</span>resource_ <span style="color: #990000">=</span> nullptr<span style="color: #990000">;</span>

      size_ <span style="color: #990000">=</span> m<span style="color: #990000">.</span>size_<span style="color: #990000">;</span>
      m<span style="color: #990000">.</span>size_ <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>

      data_ <span style="color: #990000">=</span> std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>m<span style="color: #990000">.</span>data_<span style="color: #990000">);</span>
   <span style="color: #FF0000">}</span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Howard Hinnant (the man that pretty much single handedly wrote clang&#8217;s libstdc++ from scratch)
  argues that you shouldn&#8217;t do this because:
</p>
<div class="ulist"><ul>
<li>
<p>
An rvalue reference promises that you either have a temporary, or are being promised that you
      are working with a temporary.
</p>
</li>
<li>
<p>
If you have a reference to a true temporary, then the reference you hold is unique, and
      self-assignment is literally impossible.
</p>
</li>
<li>
<p>
If you haven&#8217;t received a reference to a temporary, then the client has a bug. It&#8217;s <em>their</em>
      fault, and <em>their</em> problem to fix.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Howard also believes this is better than the above (and given the above arguments, I&#8217;m inclined
  to agree):
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;</span> magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;::</span><span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span>magic<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;&amp;&amp;</span> m<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #000000">assert</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span> <span style="color: #990000">!=</span> <span style="color: #990000">&amp;</span>r<span style="color: #990000">);</span>
   <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span><span style="color: #990000">[]</span> resource_<span style="color: #990000">;</span>
   resource_ <span style="color: #990000">=</span> m<span style="color: #990000">.</span>resource_<span style="color: #990000">;</span>
   m<span style="color: #990000">.</span>resource_ <span style="color: #990000">=</span> nullptr<span style="color: #990000">;</span>

   data_ <span style="color: #990000">=</span> std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>m<span style="color: #990000">.</span>data_<span style="color: #990000">);</span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">*</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
This way, the client is forced to fix their problem, rather than dart around it.
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="ulist"><ul>
<li>
<p>
Not everything is moveable (built-in types, stack-allocated arrays, etc.).
</p>
</li>
<li>
<p>
Some things that can be moved can&#8217;t be copied (e.g. <code>unique_ptr</code>).
</p>
<div class="ulist"><ul>
<li>
<p>
These do not fall under the rule of three or five.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Similarly to the rule of three, tools may help, but they probably won&#8217;t. Be vigilant.
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
<a href="https://youtu.be/xnqTKD8uD64?t=51m6s">CppCon 2014: Herb Sutter "Back to the Basics!
  Essentials of Modern C++ Style"</a>
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective modern C++&#8201;&#8212;&#8201;42 ways to improve your use of C++11 and C++14</em>. p.157
 &#8201;&#8212;&#8201;177, 203&#8201;&#8212;&#8201;6. 2014. O&#8217;Reilly Media Inc. Sebastopol, CA.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.514&#8201;&#8212;&#8201;523. 2013. Pearson
  Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>Programming: principles and practice using C++</em>. 2nd Edition. p.601&#8201;&#8212;&#8201;5,
  637&#8201;&#8212;&#8201;646. 2014. Pearson Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
<a href="http://stackoverflow.com/a/9322542/4097528">StackOverflow: Howard Hinnant&#8217;s answer to
  "Move assignment operator and <code>if (this != &amp;rhs)</code>"</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/05/06/gotw-1-variable-initialization-or-is-it-310/">GotW #1:
  Variable Initializationor Is It? (3/10)</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/05/09/gotw-2-temporary-objects-510/">GotW #2: Temporary Objects</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/05/13/gotw-3-using-the-standard-library-or-temporaries-revisited-310/">GotW #3:
  Using the Standard Library (or, Temporaries Revisited) (3/10)</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Res-move">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.56: Write <code>std::move()</code> only when you need to explicitly move an object to another scope</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#f6-if-your-function-may-not-throw-declare-it-noexcept">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.6: If your function may not throw, declare it <code>noexcept</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#f18-for-consume-parameters-pass-by-x-and-stdmove-the-parameter">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.18: For "consume" parameters, pass by <code>X&amp;&amp;</code> and <code>std::move</code> the parameter</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rf-return-ref-ref">CppCoreGuidelines
 &#8201;&#8212;&#8201;F.45 Don&#8217;t return a <code>T&amp;&amp;</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-copy-self">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.62: Make copy assignment safe for self-assignment</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-move-assignment">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.63: Make move assignment non-<code>virtual</code>, take the parameter by <code>&amp;&amp;</code>, and return by non-<code>const &amp;</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-move-semantic">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.64: A move operation should move and leave its source in a valid state</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c65-make-move-assignment-safe-for-self-assignment">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.65: Make move assignment safe for self-assignment</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-move-noexcept">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.66: Make move operations <code>noexcept</code></a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#define-copy-move-and-destroy-consistently">CppCoreGuidelines
 &#8201;&#8212;&#8201;Define Copy, move, and destroy consistently</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Cr-value-return">CppCoreGuidelines
 &#8201;&#8212;&#8201;Return containers by value (relying on move or copy elision for efficiency)</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#if-a-class-is-a-resource-handle-it-needs-a-constructor-a-destructor-and-copy-andor-move-operations">CppCoreGuidelines
 &#8201;&#8212;&#8201;If a class is a resource handle, it needs a constructor, a destructor, and copy and/or move
  operations</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_rule_of_zero">The rule of zero</h3>
<div class="ulist"><ul>
<li>
<p>
Don&#8217;t provide a custom copy/move constructor, or a custom copy/move assignment operator!
</p>
</li>
<li>
<p>
<span class="big"><strong>If your type doesn&#8217;t personally manage a resource, don&#8217;t bother with <em>any</em> of the five.</strong></span>
</p>
</li>
<li>
<p>
The compiler will synthesise a perfectly working copy constructor, move constructor, copy
  assignment operator, move assignment operator, and destructor for you.
</p>
<div class="ulist"><ul>
<li>
<p>
These will call the appropriate constructors for all of your members.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The rule of zero often isn&#8217;t applicable to library developers (which is why you need to write all
  five in the second assignment).
</p>
</li>
<li>
<p>
Why is the rule of zero recommended?
</p>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
You don&#8217;t need to write five functions&#8201;&#8212;&#8201;less to write
</p>
</li>
<li>
<p>
You don&#8217;t need to write five <em>complex</em> functions&#8201;&#8212;&#8201;less to think about
</p>
</li>
<li>
<p>
You don&#8217;t need to <em>test</em> five complex functions&#8201;&#8212;&#8201;less to test
</p>
</li>
<li>
<p>
Someone has already done the work&#8230; just elsewhere! Don&#8217;t reinvent the wheel!
</p>
</li>
</ol></div>
</li>
<li>
<p>
Unless I&#8217;m implementing library code, I stick to the rule of zero.
</p>
</li>
<li>
<p>
What about if you want something to be moveable, but not copyable? Check out this:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">template</span></span> <span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #0000FF">typename</span></span> <span style="color: #008080">T</span><span style="color: #990000">&gt;</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">magic</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-weight: bold"><span style="color: #000000">magic</span></span><span style="color: #990000">()</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">default</span></span><span style="color: #990000">;</span>

   <span style="font-weight: bold"><span style="color: #000000">magic</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> magic<span style="color: #990000">&amp;)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span><span style="color: #990000">;</span>
   magic<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> magic<span style="color: #990000">&amp;)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">delete</span></span><span style="color: #990000">;</span>
   <span style="color: #990000">~</span><span style="font-weight: bold"><span style="color: #000000">magic</span></span><span style="color: #990000">()</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">default</span></span><span style="color: #990000">;</span>

   <span style="font-weight: bold"><span style="color: #000000">magic</span></span><span style="color: #990000">(</span>magic<span style="color: #990000">&amp;&amp;)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">default</span></span><span style="color: #990000">;</span>
   magic<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #0000FF">operator</span></span><span style="color: #990000">=(</span>magic<span style="color: #990000">&amp;&amp;)</span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">default</span></span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;T&gt;</span> data_<span style="color: #990000">;</span>
   resource_t<span style="color: #990000">*</span> resource_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
The functions that are <code>= default</code> are still synthesised by the compiler.
</p>
</li>
<li>
<p>
The functions that are <code>= delete</code> are not implemented.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>Effective modern C++&#8201;&#8212;&#8201;42 ways to improve your use of C++11 and C++14</em>. p.74
 &#8201;&#8212;&#8201;79. 2014. O&#8217;Reilly Media Inc. Sebastopol, CA.
</p>
</li>
<li>
<p>
Stroustrup, B. <em>The C++ programming language</em> 4th Edition. p.517&#8201;&#8212;&#8201;526. 2013. Pearson
  Education Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/rule_of_three">cppreference&#8201;&#8212;&#8201;The rule of
  three/five/zero</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c20-if-you-can-avoid-defining-default-operations-do">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.20: If you can avoid defining default operations, do</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-default0">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.43: Ensure that a class has a default constructor</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-default">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.45: Don&#8217;t define a default constructor that only initializes data members; use in-class
  member initializers instead</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-eqdefault">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.80: Use <code>=default</code> if you have to be explicit about using the default semantics</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Rc-delete">CppCoreGuidelines
 &#8201;&#8212;&#8201;C.81: Use <code>=delete</code> when you want to disable default behavior (without wanting an alternative)</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_copy_elision">Copy elision</h3>
<div class="ulist"><ul>
<li>
<p>
So, we&#8217;ve looked at both copy control and move semantics, or more formally known as RAII.
</p>
</li>
<li>
<p>
We&#8217;ve learned about shallow (cheap) copies and deep (expensive) copies, and how moving <em>can</em> be
  cheap for some types.
</p>
</li>
<li>
<p>
"<em>Chris! Does this mean you&#8217;ve been lying to us this whole time? That we should be returning
  local variables via <code>std::move</code>?</em>" you might ask at this point.
</p>
</li>
<li>
<p>
Do you mean like <em>this</em> code, shown below?
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;int&gt;</span> <span style="font-weight: bold"><span style="color: #000000">make_school</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> <span style="color: #009900">int</span> children<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> crowd <span style="color: #990000">=</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">int</span><span style="color: #990000">&gt;</span><span style="color: #FF0000">{}</span><span style="color: #990000">;</span>

   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> generator <span style="color: #990000">=</span> std<span style="color: #990000">::</span>mt19937<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>random_device<span style="color: #FF0000">{}</span><span style="color: #990000">()</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> distribute <span style="color: #990000">=</span> std<span style="color: #990000">::</span>uniform_int_distribution<span style="color: #990000">&lt;&gt;</span><span style="color: #FF0000">{</span><span style="color: #993399">12</span><span style="color: #990000">,</span> <span style="color: #993399">19</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>

   std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">generate_n</span></span><span style="color: #990000">(</span>std<span style="color: #990000">::</span>back_insert_iterator<span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>crowd<span style="color: #990000">)&gt;</span><span style="color: #FF0000">{</span>crowd<span style="color: #FF0000">}</span><span style="color: #990000">,</span> children<span style="color: #990000">,</span>
                   <span style="color: #990000">[&amp;]</span><span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">distribute</span></span><span style="color: #990000">(</span>generator<span style="color: #990000">);</span> <span style="color: #FF0000">}</span><span style="color: #990000">);</span>

   <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>crowd<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
"Yes! That&#8217;s exactly what I mean! Won&#8217;t that force the compiler not to make a copy, thus making
  my code more efficient?"
</p>
</li>
<li>
<p>
<strong><span class="big">NO!</span></strong>
</p>
</li>
<li>
<p>
Did you write a test to check that it&#8217;s more efficient?
</p>
<div class="ulist"><ul>
<li>
<p>
If you did, and still came to that conclusion, you&#8217;d be lying.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Do not, under any circumstances, return by wrapping your object in <code>std::move</code>.
</p>
</li>
<li>
<p>
The compiler is allowed to perform an optimisation known as <em>copy elision</em>.
</p>
<div class="ulist"><ul>
<li>
<p>
Under certain conditions, the compiler is allowed to eliminate the need for calling both the
     copy constructor and the move constructor.
</p>
</li>
</ul></div>
</li>
<li>
<p>
When these conditions aren&#8217;t met, or if the compiler doesn&#8217;t perform the optimisation, the
  compiler will automatically perform a move anyway.
</p>
</li>
<li>
<p>
By adding <code>std::move</code>, you will:
</p>
<div class="ulist"><ul>
<li>
<p>
At best, do nothing
</p>
</li>
<li>
<p>
At worst, trick the compiler into not doing the copy/move constructor elimination.
</p>
</li>
</ul></div>
</li>
<li>
<p>
This is one of the <em>very few</em> hard and fast rules that I assert.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>More effective C++: 35 new ways to improve your programs and designs</em>. p.169&#8201;&#8212;&#8201;177. 1996.
  Addison Wesley. Westford, MA.
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective modern C++&#8201;&#8212;&#8201;42 ways to improve your use of C++11 and C++14</em>. p.74
 &#8201;&#8212;&#8201;79. 2014. O&#8217;Reilly Media Inc. Sebastopol, CA.
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#es56-write-stdmove-only-when-you-need-to-explicitly-move-an-object-to-another-scope">CppCoreGuidelines
 &#8201;&#8212;&#8201;ES.56: Write <code>std::move()</code> only when you need to explicitly move an object to another scope</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#Cr-value-return">CppCoreGuidelines
 &#8201;&#8212;&#8201;Return containers by value (relying on move or copy elision for efficiency)</a>
</p>
</li>
<li>
<p>
<a href="http://en.cppreference.com/w/cpp/language/copy_elision">cppreference&#8201;&#8212;&#8201;Copy elision</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_passing_by_parameters_revisited">Passing by parameters revisited</h3>
<div class="ulist"><ul>
<li>
<p>
You might be wondering whether or not what the rules are regarding pass by rvalue reference, since
  there are rules for passing by value, passing by reference, and passing by reference-to-<code>const</code>.
</p>
</li>
<li>
<p>
Since there&#8217;s two types of reference, should we be writing:
</p>
<div class="ulist"><ul>
<li>
<p>
one function that passes by reference-to-<code>const</code> for non-destructive reads, and
</p>
</li>
<li>
<p>
one function that passes by rvalue reference for destructive reads?
</p>
</li>
</ul></div>
</li>
<li>
<p>
If you think about that for long enough, you should conclude that you&#8217;ll have a combinatorial
  number of functions to write, based on the number of parameters:
</p>
<div class="ulist"><ul>
<li>
<p>
1 parameter &#8594; 2 functions
</p>
</li>
<li>
<p>
2 parameters &#8594; 4 functions
</p>
</li>
<li>
<p>
3 parameters &#8594; 8 functions
</p>
</li>
<li>
<p>
so on&#8230;
</p>
</li>
</ul></div>
</li>
<li>
<p>
You&#8217;ll be relieved to hear that for most people, you <em>don&#8217;t</em> need to pass by rvalue reference,
  most of the time.
</p>
<div class="ulist"><ul>
<li>
<p>
You can probably get away without calling <code>std::move</code> on a regular basis.
</p>
</li>
<li>
<p>
I&#8217;ve only rarely called <code>std::move</code> outside of a move constructor/assignment operator,
         because I rely on moving temporaries.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Library writers need to be more aware of passing by rvalue reference, but only in certain sections
  of their code.
</p>
</li>
<li>
<p>
Passing by value can invoke either the copy constructor or the move constructor based on the
  context.
</p>
</li>
<li>
<p>
In 2009, people started getting excited about move semantics, and started pathologically passing
  by value much more often.
</p>
</li>
<li>
<p>
You will probably make things much slower by passing by value (you can see tests in the video
  linked below).
</p>
<div class="ulist"><ul>
<li>
<p>
So pass by reference-to-<code>const</code>, as normal.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The last point applies to all functions except for constructors, and <em>only</em> constructors.
</p>
</li>
<li>
<p>
Only after performance testing that proves the following is <em>undoubtedly</em> faster than passing by
  reference-to-<code>const</code>, should you consider the following:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">film</span>
<span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">public</span></span><span style="color: #990000">:</span>
   <span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span>std<span style="color: #990000">::</span>string<span style="color: #990000">,</span> std<span style="color: #990000">::</span>string<span style="color: #990000">,</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span>std<span style="color: #990000">::</span>string<span style="color: #990000">&gt;,</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>int64_t<span style="color: #990000">);</span>
   <span style="font-weight: bold"><span style="color: #0000FF">const</span></span> std<span style="color: #990000">::</span>string<span style="color: #990000">&amp;</span> <span style="font-weight: bold"><span style="color: #000000">title</span></span><span style="color: #990000">()</span> <span style="font-weight: bold"><span style="color: #0000FF">const</span></span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #0000FF">private</span></span><span style="color: #990000">:</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> title_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">string</span> director_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;std::string&gt;</span> cast_<span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue_<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span>

film<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">film</span></span><span style="color: #990000">(</span>std<span style="color: #990000">::</span><span style="color: #008080">string</span> title<span style="color: #990000">,</span> std<span style="color: #990000">::</span><span style="color: #008080">string</span> director<span style="color: #990000">,</span> std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;std::string&gt;</span> cast<span style="color: #990000">,</span> std<span style="color: #990000">::</span><span style="color: #008080">int64_t</span> revenue<span style="color: #990000">);</span>
   <span style="color: #990000">:</span> title_<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>title<span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     director_<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>director<span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     cast_<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">move</span></span><span style="color: #990000">(</span>cast<span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">,</span>
     revenue_<span style="color: #FF0000">{</span>revenue<span style="color: #FF0000">}</span>
<span style="color: #FF0000">{</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
<a href="https://youtu.be/xnqTKD8uD64?t=51m6s">CppCon 2014: Herb Sutter "Back to the Basics!
  Essentials of Modern C++ Style"</a>
</p>
</li>
<li>
<p>
Meyers, S. <em>Effective modern C++&#8201;&#8212;&#8201;42 ways to improve your use of C++11 and C++14</em>. p.281
 &#8201;&#8212;&#8201;292. 2014. O&#8217;Reilly Media Inc. Sebastopol, CA.
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_s_most_vexing_parse">C++'s most vexing parse</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Pop quiz: does this code compile?
</p>
<div class="ulist"><ul>
<li>
<p>
Why or why not?
</p>
</li>
<li>
<p>
If it does compile, what is its output?
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;algorithm&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iterator&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;vector&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   constexpr <span style="color: #008080">auto</span> size  <span style="color: #990000">=</span> <span style="color: #993399">8</span><span style="color: #990000">;</span>
   constexpr <span style="color: #008080">auto</span> value <span style="color: #990000">=</span> <span style="color: #993399">20</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;double&gt;</span> <span style="font-weight: bold"><span style="color: #000000">foo</span></span><span style="color: #990000">(</span>size<span style="color: #990000">,</span> value<span style="color: #990000">);</span>
   std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
             std<span style="color: #990000">::</span>ostream_iterator<span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">)::</span>value_type<span style="color: #990000">&gt;</span><span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>cout<span style="color: #990000">,</span> <span style="color: #FF0000">" "</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>

   std<span style="color: #990000">::</span>cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">'</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Yes, it compiles!
</p>
</li>
<li>
<p>
The output is the number 20, printed eight times, each print on a separate line.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
How about this code?
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;algorithm&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iterator&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;vector&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   constexpr <span style="color: #008080">auto</span> size <span style="color: #990000">=</span> <span style="color: #993399">8</span><span style="color: #990000">;</span>
   constexpr <span style="color: #008080">auto</span> value <span style="color: #990000">=</span> <span style="color: #993399">20</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;double&gt;</span> <span style="font-weight: bold"><span style="color: #000000">foo</span></span><span style="color: #990000">(</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">size_t</span></span><span style="color: #990000">(</span>size<span style="color: #990000">),</span> <span style="color: #009900">double</span><span style="color: #990000">(</span>value<span style="color: #990000">));</span>
   std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
             std<span style="color: #990000">::</span>ostream_iterator<span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">)::</span>value_type<span style="color: #990000">&gt;</span><span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>cout<span style="color: #990000">,</span> <span style="color: #FF0000">" "</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>

   std<span style="color: #990000">::</span>cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">'</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
No, this code doesn&#8217;t compile!
</p>
</li>
<li>
<p>
What&#8217;s the error?
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>cjdb<span style="color: #990000">:</span> g<span style="color: #990000">++</span> <span style="color: #990000">-</span>Wall <span style="color: #990000">-</span>Wextra <span style="color: #990000">-</span>Werror <span style="color: #990000">-</span>pedantic <span style="color: #990000">-</span>std<span style="color: #990000">=</span>c<span style="color: #990000">++</span><span style="color: #993399">14</span> <span style="color: #990000">-</span>o <span style="color: #008080">mvp</span> mvp<span style="color: #990000">.</span>cpp
mvp<span style="color: #990000">.</span>cpp<span style="color: #990000">:</span> In function <span style="color: #008080">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span><span style="color: #990000">:</span>
mvp<span style="color: #990000">.</span>cpp<span style="color: #990000">:</span><span style="color: #993399">11</span><span style="color: #990000">:</span><span style="color: #993399">18</span><span style="color: #990000">:</span> error<span style="color: #990000">:</span> request <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> member cbegin in foo<span style="color: #990000">,</span> which is <span style="color: #008080">of</span> non<span style="color: #990000">-</span><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">type</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">double</span><span style="color: #990000">&gt;(</span>std<span style="color: #990000">::</span>size_t<span style="color: #990000">,</span> <span style="color: #009900">double</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span><span style="color: #008080">aka</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">double</span><span style="color: #990000">&gt;(</span><span style="color: #009900">long</span> <span style="color: #009900">long</span> <span style="color: #009900">unsigned</span> <span style="color: #009900">int</span><span style="color: #990000">,</span> <span style="color: #009900">double</span><span style="color: #990000">)</span><span style="color: #FF0000">}</span>
    std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
                  <span style="color: #990000">^</span>
mvp<span style="color: #990000">.</span>cpp<span style="color: #990000">:</span><span style="color: #993399">11</span><span style="color: #990000">:</span><span style="color: #993399">32</span><span style="color: #990000">:</span> error<span style="color: #990000">:</span> request <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> member cend in foo<span style="color: #990000">,</span> which is <span style="color: #008080">of</span> non<span style="color: #990000">-</span><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">type</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">double</span><span style="color: #990000">&gt;(</span>std<span style="color: #990000">::</span>size_t<span style="color: #990000">,</span> <span style="color: #009900">double</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span><span style="color: #008080">aka</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">double</span><span style="color: #990000">&gt;(</span><span style="color: #009900">long</span> <span style="color: #009900">long</span> <span style="color: #009900">unsigned</span> <span style="color: #009900">int</span><span style="color: #990000">,</span> <span style="color: #009900">double</span><span style="color: #990000">)</span><span style="color: #FF0000">}</span>
    std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
                                <span style="color: #990000">^</span>
cc1plus<span style="color: #990000">:</span> all warnings being treated as errors</tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
That&#8217;s odd&#8230; foo was clearly defined in the second line of <code>main</code>&#8230;
</p>
<div class="ulist"><ul>
<li>
<p>
There&#8217;s a few more errors that have been omitted because they aren&#8217;t relevant.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The problem is with the line <code>std::vector&lt;int&gt; foo(std::size_t(size));</code>
</p>
<div class="ulist"><ul>
<li>
<p>
We tried to convert <code>size</code> an unsigned integer type, because the previous program had a
     narrowing conversion.
</p>
</li>
<li>
<p>
We also tried to convert <code>value</code> to a floating-point number type, because the previous program
     had another narrowing conversion.
</p>
</li>
<li>
<p>
The problem is that based on C++'s parsing rules, <code>foo</code> is a function declaration!
</p>
</li>
<li>
<p>
What about the <code>size_t(size)</code>, you ask?
</p>
</li>
<li>
<p>
That&#8217;s a parameter of type <code>std::size_t</code>, and is named <code>size</code> in this declaration.
</p>
</li>
</ul></div>
</li>
<li>
<p>
This problem has been titled "C++'s Most Vexing Parse" by Scott Meyers.
</p>
<div class="ulist"><ul>
<li>
<p>
He&#8217;s da real MVP!
</p>
</li>
</ul></div>
</li>
<li>
<p>
So, how do we stop MVP?
</p>
</li>
<li>
<p>
Two ways, and you should already be employing the second way.
</p>
</li>
<li>
<p>
The first way is to use list-initialisation (with <code>{}</code> instead of <code>()</code>):
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;algorithm&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iterator&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;vector&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   constexpr <span style="color: #008080">auto</span> size <span style="color: #990000">=</span> <span style="color: #993399">8</span><span style="color: #990000">;</span>
   constexpr <span style="color: #008080">auto</span> value <span style="color: #990000">=</span> <span style="color: #993399">20</span><span style="color: #990000">;</span>
   std<span style="color: #990000">::</span><span style="color: #008080">vector&lt;double&gt;</span> foo<span style="color: #FF0000">{</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">size_t</span></span><span style="color: #990000">(</span>size<span style="color: #990000">),</span> <span style="color: #009900">double</span><span style="color: #990000">(</span>value<span style="color: #990000">)</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// notice the braces, not the parentheses</span></span>
   std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
             std<span style="color: #990000">::</span>ostream_iterator<span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">)::</span>value_type<span style="color: #990000">&gt;</span><span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>cout<span style="color: #990000">,</span> <span style="color: #FF0000">" "</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>

   std<span style="color: #990000">::</span>cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">'</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
Let&#8217;s run the program:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #993399">8</span> <span style="color: #993399">20</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
The output isn&#8217;t the same!
</p>
<div class="ulist"><ul>
<li>
<p>
"Initializer-list constructors are favored over other constructors in list-initialization"&#8201;&#8212;&#8201;     Working Draft for Standard C++.
</p>
</li>
<li>
<p>
This means that the vector takes two doubles, rather than a <code>size_t</code> and a <code>double</code>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
The second way, which is preferable, is via <code>auto</code>:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;algorithm&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iterator&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;vector&gt;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   constexpr <span style="color: #008080">auto</span> size <span style="color: #990000">=</span> <span style="color: #993399">8</span><span style="color: #990000">;</span>
   constexpr <span style="color: #008080">auto</span> value <span style="color: #990000">=</span> <span style="color: #993399">20</span><span style="color: #990000">;</span>

   <span style="font-weight: bold"><span style="color: #0000FF">auto</span></span> foo <span style="color: #990000">=</span> std<span style="color: #990000">::</span>vector<span style="color: #990000">&lt;</span><span style="color: #009900">int</span><span style="color: #990000">&gt;(</span>std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">size_t</span></span><span style="color: #990000">(</span>size<span style="color: #990000">),</span> <span style="color: #009900">double</span><span style="color: #990000">(</span>value<span style="color: #990000">));</span>
   std<span style="color: #990000">::</span><span style="font-weight: bold"><span style="color: #000000">copy</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cbegin</span></span><span style="color: #990000">(),</span> foo<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cend</span></span><span style="color: #990000">(),</span>
             std<span style="color: #990000">::</span>ostream_iterator<span style="color: #990000">&lt;</span><span style="font-weight: bold"><span style="color: #000000">decltype</span></span><span style="color: #990000">(</span>foo<span style="color: #990000">)::</span>value_type<span style="color: #990000">&gt;</span><span style="color: #FF0000">{</span>std<span style="color: #990000">::</span>cout<span style="color: #990000">,</span> <span style="color: #FF0000">" "</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>

   std<span style="color: #990000">::</span>cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">'</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
That works, even though it "looks" like the previous one.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span> <span style="color: #993399">20</span></tt></pre></div></div>
<div class="ulist"><ul>
<li>
<p>
An even better solution is to choose your types correctly, and not requiring conversion.
</p>
</li>
<li>
<p>
Prefer a combination of automatic type deduction <em>and</em> list-initialisation.
</p>
<div class="ulist"><ul>
<li>
<p>
That is, always put <code>auto</code> on the left-hand side (even for fundamental types).
</p>
</li>
<li>
<p>
On the right-hand side, choose based on whether you need list-initalisation or a constructor.
</p>
</li>
<li>
<p>
If it doesn&#8217;t matter between the two, choose list-initialisation.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">References</div>
<div class="ulist"><ul>
<li>
<p>
Meyers, S. <em>Effective STL: 50 specific ways to improve your use of the standard template
  library</em>. p.33&#8201;&#8212;&#8201;35. 2001. Pearson Education, Inc. Upper Saddle River, NJ.
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/06/05/gotw-92-auto-variables-part-1/">GotW #92: Auto Variables,
  Part 1</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/06/07/gotw-93-auto-variables-part-2/">GotW #93: Auto Variables,
  Part 2</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/06/13/gotw-94-special-edition-aaa-style-almost-always-auto/">GotW
  #94 Special Edition: AAA Style (Almost Always Auto)</a>
</p>
</li>
<li>
<p>
<a href="https://herbsutter.com/2013/08/12/gotw-94-solution-aaa-style-almost-always-auto/">GotW #94
  Solution: AAA Style (Almost Always Auto)</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version 1<br />
Last updated 2016-09-01 19:06:48 AEST
</div>
</div>
</body>
</html>
